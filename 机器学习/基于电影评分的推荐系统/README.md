# åŸºäºç”µå½±è¯„åˆ†çš„æ¨èç³»ç»Ÿ

â€¢     åŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†çš„æ¨è

â€¢     åŸºäºç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤æ¨è

â€¢     åŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨è

ç»˜åˆ¶å¤§è‡´**è¿‡ç¨‹æµç¨‹å›¾**å¦‚ä¸‹ï¼š

<img src="https://gitee.com/XiaoJing-C/images/raw/master/img/20210723130748.png" style="zoom:100%;" />

 

 

ç»˜åˆ¶å¤§è‡´**åŸç†æµç¨‹å›¾**å¦‚ä¸‹ï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723130847.png)

## ä¸€ã€ç¯å¢ƒå‡†å¤‡

### å®éªŒç¯å¢ƒï¼š

`Anaconda 4.8.5 + Python 3.6.10` 

**æ‰€éœ€ç¨‹åºåŒ…ï¼š**`lenskit 0.7.0 + pandas 1.1.1 + numpy 1.19.2 + seaborn 0.11.0`

é™¤ `lenskit` ä¹‹å¤–ï¼Œå…¶ä»–ç¨‹åºåŒ…éƒ½å¯ä»¥é€šè¿‡ `pip` å‘½ä»¤ç›´æ¥å®‰è£…ï¼Œç”±äºæˆ‘çš„è™šæ‹Ÿç¯å¢ƒå·²ç»å®‰è£…å¥½è¿™äº›åŸºæœ¬çš„ç¨‹åºåŒ…ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚

**å…³äºlenskit:**

`Lenskit` æ˜¯ä¸€ç»„ç”¨äºè¯•éªŒå’Œç ”ç©¶æ¨èç³»ç»Ÿçš„Pythonå·¥å…·é›†ï¼Œå®ƒä»¥çµæ´»çš„æ–¹å¼ä¸ºè®­ç»ƒã€è¿è¡Œå’Œè¯„ä¼°æ¨èç¨‹åºç®—æ³•æä¾›æ”¯æŒï¼Œé€‚åˆäºç ”ç©¶å’Œæ•™å­¦ã€‚

å®˜æ–¹æ–‡æ¡£ï¼šhttps://lkpy.readthedocs.io/en/stable/

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723130905.png)

å®˜æ–¹æ–‡æ¡£æä¾›äº†ä¸‰ç§å®‰è£…æ–¹å¼ï¼š

1ã€ä½¿ç”¨anaconda å®‰è£…å½“å‰ç‰ˆæœ¬ 

`conda install -c lenskit lenskit`

2ã€ä½¿ç”¨pipå®‰è£…

`pip install lenskit`

3ã€ç›´æ¥ä»GitHubå®‰è£…

`pip install git+https://github.com/lenskit/lkpy`

ä½¿ç”¨å‰ä¸¤ç§æ–¹æ³•å®‰è£…ï¼Œå°†å®‰è£…æœ€æ–°ç‰ˆæœ¬ 0.9.0ï¼Œä½¿ç”¨ç¬¬ä¸‰ç§æ–¹æ³•å®‰è£…ï¼Œå°†å®‰è£…ç¨³å®šç‰ˆ0.11.1ã€‚ä¸¤ä¸ªç‰ˆæœ¬éƒ½è¿›è¡Œäº†å°è¯•ï¼Œå‘ç°åœ¨å¯¼åŒ…ç¯èŠ‚å‡ä¼šå‡ºç°å¦‚ä¸‹æ‰€ç¤ºé”™è¯¯ï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723130924.png) 

é”™è¯¯æç¤ºä¿¡æ¯æ˜¾ç¤ºæ— æ³•å¯¼å…¥æ–¹æ³• UnratedCandidatesï¼ŒæŸ¥çœ‹ topn.py æºç ï¼Œå‘ç°ç¡®å®ä¸å­˜åœ¨è¯¥æ–¹æ³•ã€‚ 

æŸ¥é˜…å®˜æ–¹æ–‡æ¡£åå‘ç°è¿™ä¸¤ä¸ªç‰ˆæœ¬å‡å·²ç»æ‘’å¼ƒäº†è¿™ä¸ªæ–¹æ³•ï¼Œäºæ˜¯æŸ¥çœ‹å®éªŒå¹³å°æ‰€ä½¿ç”¨çš„lenskitç‰ˆæœ¬å·ã€‚

<div align=left><img src="https://gitee.com/XiaoJing-C/images/raw/master/img/20210723130950.png" style="zoom:100%;" /></div>

 

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¹³å°ä½¿ç”¨çš„ lenskit ä¸º0.7.0ç‰ˆæœ¬ã€‚äºæ˜¯å¸è½½å·²å®‰è£…å¥½çš„lenskitï¼Œé‡æ–°è¿›è¡Œå®‰è£…ã€‚

<div align=left><img src="https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131040.png" style="zoom:100%;" /></div>

 

<div align=left><img src="https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131107.png" style="zoom:100%;" /></div>

åˆ°æ­¤ï¼Œç¯å¢ƒæ­å»ºå·²å®Œæˆã€‚

### æ•°æ®é›†ï¼š

ä¸‹è½½åœ°å€ï¼šhttps://grouplens.org/datasets/movielens/

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131136.png)

ä¸‹è½½ small å°å‹æ•°æ®å‹ç¼©åŒ…ï¼Œå…¶ä¸­åŒ…å«å››ä¸ªæ•°æ®é›† ï¼Œæˆ‘ä»¬ä½¿ç”¨ ratings.csv å’Œ movies.csv å®Œæˆæœ¬æ¬¡å®éªŒã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131205.png)

ratings.csv æ˜¯ç”µå½±è¯„åˆ†å†å²æ•°æ®é›†ï¼ŒåŒ…å« 100836 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬åŒ…å« 4 ä¸ªå±æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131217.png)

movies.csv æ˜¯ç”µå½±ä¿¡æ¯æ•°æ®é›†ï¼ŒåŒ…å« 9742 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬åŒ…å« 3 ä¸ªå±æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131225.png)

ç”±äºä¸‹è½½çš„æ•°æ®é›†ä¸å¹³å°æ•°æ®é›†é™¤æ ·æœ¬æ•°æœ‰å·®åˆ«å¤–ï¼Œå…¶ä»–å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥ä¸ç”¨è¿›è¡Œ**æ•°æ®æ¸…æ´—**ã€‚

## äºŒã€æ¢ç´¢æ€§æ•°æ®åˆ†æ

#### 1ã€è½½å…¥å®éªŒéœ€è¦çš„è½¯ä»¶åŒ…

â€¢     lenskit

â€¢     pandasï¼šç”¨äºæ•°æ®åˆ†æå’Œå¤„ç†

â€¢     matplotlibï¼šç”¨äºç”»å›¾ï¼Œå®ç°æ•°æ®å¯è§†åŒ–

â€¢     numpyï¼šç”¨äºå­˜å‚¨å¤„ç†æ•°æ®

â€¢     seabornï¼šç”¨äºæ•°æ®å¯è§†åŒ–

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131239.png)

#### 2ã€æ•°æ®è¯»å–

â€¢     è¯»å–ç”µå½±è¯„åˆ†å†å²æ•°æ®é›† ratingsï¼Œå¹¶ä¿®æ”¹å˜é‡åï¼Œä½¿ç”¨ rename å‡½æ•°å°†åŸæ•°æ®è¡¨ä¸­ userId å­—æ®µæ”¹ä¸º user ï¼ŒmovieId æ”¹ä¸º itemï¼Œå®ç°è§åçŸ¥æ„ï¼Œä¸”æ–¹ä¾¿åç»­æ“ä½œã€‚æ‰“å°æ•°æ®ç»´åº¦å¹¶ä½¿ç”¨ head( ) å‡½æ•°æŸ¥çœ‹å‰å‡ è¡Œã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131251.png)      

â€¢     åŒæ ·çš„ï¼Œè¯»å–ç”µå½±ä¿¡æ¯æ•°æ®é›† moviesï¼Œä¿®æ”¹å˜é‡åç§°ï¼Œå¹¶æŸ¥çœ‹æ•°æ®é›†çš„ç»´åº¦å’Œå‰å‡ è¡Œã€‚ 

#### ![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131303.png)

#### 3ã€æ•°æ®èšåˆä¸è¿æ¥

â€¢     å°†åŸºäºç”µå½±è¯„åˆ†å†å²æ•°æ®é›† ratingsï¼ŒæŒ‰ç…§å˜é‡ item åšèšåˆï¼Œè®¡ç®—å„ç”µå½±çš„å¹³å‡è¯„åˆ†å’Œè¯„åˆ†æ•°é‡ï¼ŒæŸ¥çœ‹å‰å‡ è¡Œã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131321.png)â€¢     ä½¿ç”¨mergeå‡½æ•°ä¸ç”µå½±ä¿¡æ¯æ•°æ®é›† movies åšå†…è¿æ¥ï¼Œæ·»åŠ ç”µå½±çš„æ ‡é¢˜ï¼ˆå˜é‡ title ï¼‰å’Œé¢˜æï¼ˆå˜é‡ genres )ï¼Œå°†è¿æ¥åçš„æ•°æ®å­˜åœ¨æ–°å˜é‡ movie_ratings ä¸­ï¼Œ æŸ¥çœ‹å‰å‡ è¡Œã€‚ 

â€“     å¯ä»¥çœ‹åˆ°æ–°çš„æ•°æ®é›†ç”± rating_meanã€rating_countã€itemsã€titleã€genres è¿™äº”ä¸ªå±æ€§æ„æˆã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131341.png) 

â€¢     ä½¿ç”¨ dropna å‡½æ•°åˆ é™¤ç¼ºå¤±å€¼

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131355.png)

#### 4ã€ç”µå½±è¯„åˆ†åˆ†æ

â€¢     ä½¿ç”¨ seaborn åº“ä¸­çš„ countplot å‡½æ•°ç”¨æ¡å½¢æ˜¾ç¤ºæ¯ä¸ªåˆ†ç®±å™¨ä¸­çš„è§‚å¯Ÿè®¡æ•°ï¼Œç›´è§‚æ˜¾ç¤ºå‡ºè¯„åˆ†çš„åˆ†å¸ƒå›¾

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131409.png) 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131418.png)

â€‹      

â€‹      

â€‹      

â€¢     displot æ˜¯ç›´æ–¹å›¾å’Œå¯†åº¦å›¾çš„é›†åˆä½“ï¼Œç»˜åˆ¶å„ç”µå½±å¹³å‡è¯„åˆ†çš„åˆ†å¸ƒå›¾

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131428.png)

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131436.png)

â€¢    ç»˜åˆ¶å„ç”µå½±è¯„åˆ†æ•°é‡çš„åˆ†å¸ƒå›¾ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131524.png)    

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131537.png)

 

 

â€¢     å¾—åˆ°å¹³å‡è¯„åˆ†æœ€é«˜ä¸”æœ‰100æ¡ä»¥ä¸Šè¯„åˆ†çš„å‰20éƒ¨ç”µå½±

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131549.png)

â€¢     ç»˜åˆ¶è¿™20éƒ¨ç”µå½±çš„å¹³å‡è¯„åˆ†

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131602.png) 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131612.png)

 

â€¢     å°† ascending å‚æ•°è®¾ä¸º False ï¼Œå®ç°é™åºæ’åˆ—ï¼Œä»¥æ­¤å¾—åˆ°è¯„åˆ†æ•°é‡æœ€å¤šçš„å‰20éƒ¨ç”µå½±

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131624.png)

â€¢     ç»˜åˆ¶è¿™20éƒ¨ç”µå½±çš„è¯„åˆ†æ•°é‡

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131635.png)

â€‹      

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131646.png)

 

## ä¸‰ã€æ•°æ®é¢„å¤„ç†

### 1ã€äº¤å‰éªŒè¯æ•°æ®åˆ†å‰²

å°†æ•°æ®é›†åˆ†ä¸º5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†åš5æŠ˜äº¤å‰éªŒè¯ã€‚å…·ä½“æ–¹æ³•ä¸ºï¼š

1. å°†ç”¨æˆ·åˆ†å‰²æˆ5ç»„æµ‹è¯•é›†ç”¨æˆ·ï¼›

2. å¯¹äºæ¯ç»„æµ‹è¯•é›†ç”¨æˆ·ï¼Œå†è¿›ä¸€æ­¥æŠ½å–è¿™äº›ç”¨æˆ·20%çš„è¯„åˆ†æ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ï¼›

3. åˆ›å»ºå¯¹åº”çš„è®­ç»ƒé›†ï¼ŒåŒ…å«è¯¥ç»„æµ‹è¯•é›†ç”¨æˆ·çš„å…¶ä½™80%çš„è¯„åˆ†æ ·æœ¬ä»¥åŠæ‰€æœ‰éæµ‹è¯•é›†ç”¨æˆ·çš„è¯„åˆ†æ ·æœ¬ã€‚

è°ƒç”¨ç¨‹åºåŒ… lenskit.crossfold ä¸­çš„å‡½æ•° partition_users() å°†æ•°æ®é›†åˆ†å‰²ä¸º5æŠ˜äº¤å‰éªŒè¯ä¸­å„æŠ˜å¯¹åº”çš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå…¶ä¸­ 

â€¢     ç¬¬1ä¸ªå‚æ•° data è¡¨ç¤ºç”¨æˆ·è¯„åˆ†æ•°æ®æ¡†ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° partitions è¡¨ç¤ºåˆ†å‰²ç”¨æˆ·çš„åˆ†ç»„æ•°ï¼Œå³äº¤å‰éªŒè¯çš„æŠ˜æ•°ï¼›

â€¢     ç¬¬3ä¸ªå‚æ•° method è¡¨ç¤ºæ¯ä¸ªç”¨æˆ·æŠ½å–è¯„åˆ†æ ·æœ¬çš„æ–¹æ³•ï¼Œè¿™é‡Œä¸ºæŠ½å–20%ï¼›

â€¢     è¿”å›ç»“æœä¸ºæˆå¯¹è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„è¿­ä»£å™¨ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131707.png)

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131722.png)

æŸ¥çœ‹æ¯ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„å½¢çŠ¶ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131737.png)

å¯ä»¥çœ‹åˆ°æ¯ç»„è®­ç»ƒé›†ä¸æµ‹è¯•é›†çš„ç»´åº¦å¦‚ä¸Šå›¾ç»“æœæ‰€ç¤ºã€‚

### 2ã€å€™é€‰æ¨èæ•°æ®å‡†å¤‡

ä½¿ç”¨ concat å‡½æ•°ï¼Œåˆ©ç”¨ for å¾ªç¯åˆå¹¶æ‰€æœ‰çš„æµ‹è¯•é›†ï¼Œä¸ºåç»­æ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131750.png)

åœ¨ç»™ç”¨æˆ·åšç”µå½±æ¨èæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªå€™é€‰æ¨èåˆ—è¡¨ã€‚

ä½†æ˜¯æ•°æ®é›†ä¸­æœ‰éƒ¨åˆ†ç”µå½±åªæœ‰æå°‘æ•°çš„è¯„åˆ†ï¼Œå¹¶ä¸ç¨³å®šï¼Œä¸é€‚åˆåšæ¨èï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å‰”é™¤æ‰€æœ‰è¯„åˆ†å°‘äº5æ¡çš„ç”µå½±è®°å½•ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131804.png)

## å››ã€åŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†çš„æ¨è

ç”¨æˆ·ç”µå½±åç§»é‡è¯„åˆ†é¢„æµ‹ç®—æ³•å®šä¹‰ä¸ºï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/clip_image002.png)

å…¶ä¸­ï¼Œ![](https://gitee.com/XiaoJing-C/images/raw/master/img/clip_image001.png)æ˜¯å…¨å±€å¹³å‡è¯„åˆ†ï¼Œ![](https://gitee.com/XiaoJing-C/images/raw/master/img/2.png)æ˜¯ç”µå½±åç§»é‡![](https://gitee.com/XiaoJing-C/images/raw/master/img/1.png)æ˜¯ç”¨æˆ·åç§»é‡ã€‚è¿›ä¸€æ­¥å¼•å…¥é˜»å°¼å‚æ•°![](https://gitee.com/XiaoJing-C/images/raw/master/img/3.png)å’Œ![](https://gitee.com/XiaoJing-C/images/raw/master/img/4.png)ï¼Œè®¡ç®—å…¬å¼ä¸º

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723131856.png)

è°ƒç”¨ç¨‹åºåŒ… lenskit.algorithms.basic ä¸­çš„æ„é€ å‡½æ•° Bias() åˆ›å»ºåç§»ç®—æ³•ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° items è¡¨ç¤ºæ˜¯å¦è®¡ç®—ç”µå½±åç§»é‡ï¼Œé»˜è®¤ä¸ºæ˜¯ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° users è¡¨ç¤ºæ˜¯å¦è®¡ç®—ç”¨æˆ·åç§»é‡ï¼Œé»˜è®¤ä¸ºæ˜¯ï¼›

â€¢     ç¬¬3ä¸ªå‚æ•° damping è¡¨ç¤ºé˜»å°¼å‚æ•°ã€‚

æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹lenskitçš„å®˜æ–¹æ–‡æ¡£è·å¾—æ›´åŠ è¯¦ç»†çš„ä»‹ç»ã€‚

lenskit.algorithms.basic æ¨¡å—åŒ…å«ä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†é¢„æµ‹ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132015.png)

 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132027.png)

æˆ‘ä»¬ä¸»è¦é‡‡ç”¨ä¸¤ç§æ–¹å¼è¯„ä¼°æ¨èç®—æ³•ã€‚

â€¢     **ç¬¬ä¸€ç§**æ˜¯ç”±æ¨èç®—æ³•é¢„æµ‹æ¯ä¸ªç”¨æˆ·è¯„åˆ†æœ€é«˜çš„å‰ğ‘˜ä¸ªç”µå½±åˆ—è¡¨ï¼Œä¸å®é™…è¯¥ç”¨æˆ·å·²è¯„åˆ†çš„ç”µå½±åšå¯¹æ¯”ï¼Œè®¡ç®—æ ¹æ®æ’ååŠ æƒçš„é‡åˆåº¦ã€‚

â€¢     **ç¬¬äºŒç§**æ˜¯ç”±æ¨èç®—æ³•é¢„æµ‹æ¯ä¸ªç”¨æˆ·å·²è¯„åˆ†çš„ç”µå½±çš„è¯„åˆ†ï¼Œä¸çœŸå®å€¼åšå¯¹æ¯”è®¡ç®—è¯¯å·®ã€‚

â€‹      

### 1ã€æ¨èåˆ—è¡¨

â€¢     éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·æ¨èæ¯ä¸ªç”¨æˆ·è¯„åˆ†æœ€é«˜çš„å‰100ä¸ªç”µå½±åˆ—è¡¨ã€‚
 

ç¨‹åºåŒ… lenskit.batch ä¸­çš„å‡½æ•° recommend() ç”¨äºç»™ç”¨æˆ·æ‰¹é‡æ¨èå½±ç‰‡ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° algoè¡¨ç¤ºæ¨èç®—æ³•ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° users è¡¨ç¤ºéœ€è¦æ¨èçš„ç”¨æˆ·åˆ—è¡¨ï¼Œè¿™é‡Œä¸ºæ‰€æœ‰æµ‹è¯•é›†ä¸­çš„ç‹¬ç«‹ç”¨æˆ·ï¼›

â€¢     ç¬¬3ä¸ªå‚æ•° n è¡¨ç¤ºæ¨èçš„ç”µå½±æ•°é‡ï¼›

â€¢     ç¬¬4ä¸ªå‚æ•° candidates è¡¨ç¤ºå€™é€‰æ¨èåˆ—è¡¨ï¼Œè¿™é‡Œè°ƒç”¨ç¨‹åºåŒ… lenskit.topn ä¸­çš„æ„é€ å‡½æ•°UnratedCandidates() è¿”å›æ¯ä¸ªç”¨æˆ·æ²¡æœ‰è¯„åˆ†è¿‡çš„ç”µå½±åˆ—è¡¨ã€‚

 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132727.png)

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„æ¨èåˆ—è¡¨ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132739.png)

ä½¿ç”¨åç§»ç®—æ³•çš„å±æ€§ mean_ã€item_offsets_ å’Œ user_offsets_ åˆ†åˆ«å¾—åˆ°å…¨å±€å¹³å‡è¯„åˆ†ğœ‡ã€æ ‡è¯†ç¬¦ä¸º1çš„ç”µå½±ï¼ˆã€Šç©å…·æ€»åŠ¨å‘˜1ã€‹)åç§»é‡ ğ‘ğ‘– å’Œæ ‡è¯†ç¬¦ä¸º145çš„ç”¨æˆ·åç§»é‡ ğ‘ğ‘¢ã€‚ 

![image-20210723132800609](C:\Users\1979\AppData\Roaming\Typora\typora-user-images\image-20210723132800609.png)

å¯ä»¥çœ‹åˆ°ï¼Œğœ‡ ä¸º 3.5002643829509283ã€ğ‘ğ‘– ä¸º 0.4599346220241948ã€ğ‘ğ‘¢ ä¸º -0.23977443873998147

è°ƒç”¨ç¨‹åºåŒ… lenskit.topn ä¸­çš„æ„é€ å‡½æ•° RecListAnalysis() åˆ›å»ºæ¨èåˆ—è¡¨åˆ†æå¯¹è±¡ã€‚è¿›ä¸€æ­¥è°ƒç”¨è¯¥å¯¹è±¡çš„å‡½æ•°add_metric æ·»åŠ è¯„ä»·æŒ‡æ ‡ï¼Œè¿™é‡Œæ·»åŠ çš„æŒ‡æ ‡ä¸ºå½’ä¸€åŒ–è¡°å‡ç´¯ç§¯å¢ç›Šï¼ˆnormalized discounted cumulative gainï¼Œç®€ç§°NDCGï¼‰ï¼Œè¿™é‡Œè°ƒç”¨ç¨‹åºåŒ… lenskit.metrics.topn ä¸­çš„å‡½æ•° ndcg() å¾—åˆ°ã€‚

å½’ä¸€åŒ–è¡°å‡ç´¯ç§¯å¢ç›Šå®šä¹‰ä¸ºï¼š

 



![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132820.png)

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134424.png)

è°ƒç”¨æ¨èåˆ—è¡¨åˆ†æå¯¹è±¡çš„å‡½æ•° compute() è®¡ç®—è¯„ä»·æŒ‡æ ‡ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° recs è¡¨ç¤ºæ¨èè¯„åˆ†çš„ç”µå½±åˆ—è¡¨ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° truth è¡¨ç¤ºç”¨æˆ·çœŸå®è¯„åˆ†çš„ç”µå½±åˆ—è¡¨ï¼›

â€¢     è¿”å›ç»“æœä¸ºæ¯ä¸ªç”¨æˆ·çš„è¯„ä»·æŒ‡æ ‡å€¼ï¼Œè¿™é‡Œä¸º NDCGã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132851.png) 

é€šè¿‡ mean å‡½æ•°å¾—åˆ°æ‰€æœ‰æµ‹è¯•é›†ç”¨æˆ·çš„ NDCG å‡å€¼ä¸º 0.017595354789097562ã€‚

### ![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132902.png)

### 2ã€è¯„åˆ†é¢„æµ‹

éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆé¢„æµ‹è¯„åˆ†ã€‚

ç¨‹åºåŒ… lenskit.batch ä¸­çš„å‡½æ•° predict() ç”¨äºç»™ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆæ‰¹é‡é¢„æµ‹è¯„åˆ†ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° algo è¡¨ç¤ºæ¨èç®—æ³•ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° pairs è¡¨ç¤ºéœ€è¦é¢„æµ‹è¯„åˆ†çš„ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆï¼Œè¿™é‡Œä¸ºæ‰€æœ‰æµ‹è¯•é›†ä¸­çš„ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132919.png) 

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„è¯„åˆ†é¢„æµ‹ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![image-20210723132935167](C:\Users\1979\AppData\Roaming\Typora\typora-user-images\image-20210723132935167.png) 

è°ƒç”¨ç¨‹åºåŒ… `lenskit.metrics.predict` ä¸­çš„å‡½æ•° `rmse()` è®¡ç®—é¢„æµ‹è¯„åˆ†ä¸çœŸå®è¯„åˆ†çš„å‡æ–¹æ ¹è¯¯å·®ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° predictions è¡¨ç¤ºé¢„æµ‹è¯„åˆ†ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° truth è¡¨ç¤ºçœŸå®è¯„åˆ†ã€‚

## ![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723132950.png)

## äº”ã€åŸºäºç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤æ¨è

è°ƒç”¨ç¨‹åºåŒ… `lenskit.algorithms.item_knn` ä¸­çš„æ„é€ å‡½æ•° `ItemItem()` åˆ›å»ºåŸºäºç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤ç®—æ³•ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° nnbrs è¡¨ç¤º k è¿‘é‚»çš„æ•°é‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133001.png)

è¿™é‡Œæˆ‘ä»¬çš„å‚æ•°è®¾ç½®ä¸º20ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133028.png)

### 1ã€æ¨èåˆ—è¡¨

éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·æ¨èæ¯ä¸ªç”¨æˆ·è¯„åˆ†æœ€é«˜çš„å‰100ä¸ªç”µå½±åˆ—è¡¨ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133039.png)

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„æ¨èåˆ—è¡¨ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133053.png)ä½¿ç”¨åŸºäºç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤ç®—æ³•çš„å±æ€§ sim_matrix_ å¾—åˆ°ç”µå½±çš„ç›¸ä¼¼åº¦çŸ©é˜µï¼Œå¹¶ç»è¿‡ä¸€ç³»åˆ—å˜æ¢å¾—åˆ°ä¸æ ‡è¯†ç¬¦ä¸º1çš„ç”µå½±ï¼ˆã€Šç©å…·æ€»åŠ¨å‘˜1ã€‹)ç›¸ä¼¼åº¦æœ€é«˜çš„å‰10ä¸ªç”µå½±ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133105.png) 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133117.png)

 

åŒæ ·çš„ï¼Œè®¡ç®—æµ‹è¯•é›†ç”¨æˆ·çš„NDCGå‡å€¼ã€‚ 

### ![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133130.png)

### 2ã€è¯„åˆ†é¢„æµ‹

éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆé¢„æµ‹è¯„åˆ†ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133449.png)

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„è¯„åˆ†é¢„æµ‹ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133506.png)

è°ƒç”¨ç¨‹åºåŒ… lenskit.metrics.predict ä¸­çš„å‡½æ•° rmse() è®¡ç®—é¢„æµ‹è¯„åˆ†ä¸çœŸå®è¯„åˆ†çš„å‡æ–¹æ ¹è¯¯å·®ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° predictions è¡¨ç¤ºé¢„æµ‹è¯„åˆ†ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° truth è¡¨ç¤ºçœŸå®è¯„åˆ†ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133518.png)



## å…­ã€åŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨è

è¯¥ç®—æ³•ä½¿ç”¨äº¤æ›¿æœ€å°äºŒä¹˜æ³•ï¼ˆalternating least squaresï¼‰è®­ç»ƒåå·®çŸ©é˜µåˆ†è§£ã€‚

è°ƒç”¨ç¨‹åºåŒ… lenskit.algorithms.als ä¸­çš„æ„é€ å‡½æ•° BiasedMF() åˆ›å»ºåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤ç®—æ³•ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° features è¡¨ç¤ºéšå› å­çš„æ•°é‡ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° iterations è¡¨ç¤ºè¿­ä»£æ¬¡æ•°ï¼›

â€¢     ç¬¬3ä¸ªå‚æ•° reg è¡¨ç¤ºæ­£åˆ™åŒ–å‚æ•°ï¼›

â€¢     ç¬¬4ä¸ªå‚æ•° damping è¡¨ç¤ºé˜»å°¼å‚æ•°ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133532.png)

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133551.png)

### 1ã€æ¨èåˆ—è¡¨

éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·æ¨èæ¯ä¸ªç”¨æˆ·è¯„åˆ†æœ€é«˜çš„å‰100ä¸ªç”µå½±åˆ—è¡¨ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133606.png)

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„æ¨èåˆ—è¡¨ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133620.png)

è®¡ç®—æµ‹è¯•é›†ç”¨æˆ·çš„NDCGå‡å€¼ï¼Œå¾—åˆ°0.0775176690540789

### ![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133630.png)

### 2ã€è¯„åˆ†é¢„æµ‹

éå†5ç»„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ¯æ¬¡è¿­ä»£ç”¨è®­ç»ƒé›†åšè®­ç»ƒï¼Œå¹¶ç»™æµ‹è¯•é›†ä¸­çš„æ‰€æœ‰ç”¨æˆ·å’Œå½±ç‰‡ç»„åˆé¢„æµ‹è¯„åˆ†ã€‚ 

![image-20210723133851824](C:\Users\1979\AppData\Roaming\Typora\typora-user-images\image-20210723133851824.png)

åˆå¹¶æ‰€æœ‰æµ‹è¯•é›†çš„è¯„åˆ†é¢„æµ‹ï¼Œä¸ºæ¨¡å‹æ€§èƒ½è¯„ä¼°åšå‡†å¤‡ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133858.png) 

è°ƒç”¨ç¨‹åºåŒ… lenskit.metrics.predict ä¸­çš„å‡½æ•° rmse() è®¡ç®—é¢„æµ‹è¯„åˆ†ä¸çœŸå®è¯„åˆ†çš„å‡æ–¹æ ¹è¯¯å·®ï¼Œå…¶ä¸­

â€¢     ç¬¬1ä¸ªå‚æ•° predictionsè¡¨ç¤ºé¢„æµ‹è¯„åˆ†ï¼›

â€¢     ç¬¬2ä¸ªå‚æ•° truth è¡¨ç¤ºçœŸå®è¯„åˆ†ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133913.png) 

## ä¸ƒã€æ¨èç®—æ³•çš„æµ‹è¯•å’Œè¯„ä¼°

### 1ã€å½’ä¸€åŒ–è¡°å‡ç´¯ç§¯å¢ç›Šï¼ˆNDCGï¼‰

ç»˜åˆ¶3ç§æ¨èç®—æ³•ç”¨äºæ¨èåˆ—è¡¨çš„NDCGã€‚å¯ä»¥çœ‹å‡ºï¼ŒåŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†çš„æ¨èæœ€å·®ï¼ŒåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èæœ€å¥½ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723133958.png)

### 2ã€å‡æ–¹æ ¹è¯¯å·®

ç»˜åˆ¶3ç§æ¨èç®—æ³•ç”¨äºé¢„æµ‹è¯„åˆ†çš„å‡æ–¹æ ¹è¯¯å·®ã€‚å¯ä»¥çœ‹å‡ºï¼ŒåŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†çš„æ¨èæœ€å·®ï¼ŒåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èæœ€å¥½ã€‚ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134024.png)

### 3ã€æ¨èåˆ—è¡¨

å¾—åˆ°æ ‡è¯†ç¬¦ä¸º145çš„ç”¨æˆ·åœ¨æµ‹è¯•é›†ä¸­çš„ç”µå½±åˆ—è¡¨ã€‚ 

æŸ¥çœ‹è¯¥ç”¨æˆ·åœ¨è®­ç»ƒé›†ä¸­çš„ç”µå½±åˆ—è¡¨ï¼Œè¿™äº›è®°å½•è¾“å…¥äº†æ¨èç®—æ³•ç”¨äºè®­ç»ƒã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134055.png)

æŸ¥çœ‹åŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†æ¨èçš„å‰20æ¡æ¨èåˆ—è¡¨ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134111.png)

æŸ¥çœ‹ç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤æ¨èçš„å‰20æ¡æ¨èåˆ—è¡¨ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134124.png)

æŸ¥çœ‹åŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èçš„å‰20æ¡æ¨èåˆ—è¡¨ 

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134140.png)

### 4ã€è¯„åˆ†é¢„æµ‹

æŸ¥çœ‹åŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†æ¨èçš„è¯„åˆ†é¢„æµ‹ã€‚

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134159.png)

æŸ¥çœ‹ç”µå½±ç›¸ä¼¼åº¦çš„ååŒè¿‡æ»¤æ¨èçš„è¯„åˆ†é¢„æµ‹

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134216.png)

æŸ¥çœ‹åŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èçš„è¯„åˆ†é¢„æµ‹

![](https://gitee.com/XiaoJing-C/images/raw/master/img/20210723134240.png)

 

é€šè¿‡é¢„æµ‹ç»“æœä¸å®é™…å¾—åˆ†ä¹‹é—´çš„å·®è·å¯ä»¥çœ‹å‡ºï¼ŒåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èé¢„æµ‹æ•ˆæœæ›´èƒœä¸€ç­¹ã€‚

## å…«ã€æ€»ç»“

â€¢     æˆ‘ä»¬é‡‡ç”¨äº†ä¸‰ç§ä¸åŒçš„æ¨èç®—æ³•è¿›è¡Œæµ‹è¯•ï¼Œå¹¶ä¸”é€šè¿‡æµ‹è¯•ä¸è¯„ä¼°å¯ä»¥å‘ç°ï¼ŒåŸºäºä¸ªæ€§åŒ–å¹³å‡è¯„åˆ†æ¨èç®—æ³•æ€§èƒ½æœ€å·®ï¼Œè€ŒåŸºäºçŸ©é˜µåˆ†è§£çš„ååŒè¿‡æ»¤æ¨èç®—æ³•æ€§èƒ½æœ€å¥½ã€‚

â€¢     ååŒè¿‡æ»¤ç®—æ³•æ˜¯ä¸€ç§è¾ƒä¸ºè‘—åå’Œå¸¸ç”¨çš„**æ¨èç®—æ³•**ï¼Œå®ƒåŸºäºå¯¹ç”¨æˆ·å†å²è¡Œä¸ºæ•°æ®çš„æŒ–æ˜å‘ç°ç”¨æˆ·çš„å–œå¥½åå‘ï¼Œå¹¶é¢„æµ‹ç”¨æˆ·å¯èƒ½å–œå¥½çš„äº§å“è¿›è¡Œæ¨èã€‚ä¹Ÿå°±æ˜¯å¸¸è§çš„â€œçŒœä½ å–œæ¬¢â€ï¼Œå’Œâ€œè´­ä¹°äº†è¯¥å•†å“çš„äººä¹Ÿå–œæ¬¢â€ç­‰åŠŸèƒ½ã€‚å®ƒçš„ä¸»è¦å®ç°ç”±ï¼š

â€“      æ ¹æ®å’Œä½ æœ‰å…±åŒå–œå¥½çš„äººç»™ä½ æ¨è

â€“      æ ¹æ®ä½ å–œæ¬¢çš„ç‰©å“ç»™ä½ æ¨èç›¸ä¼¼ç‰©å“

â€“      æ ¹æ®ä»¥ä¸Šæ¡ä»¶ç»¼åˆæ¨è

â€¢     é€šè¿‡æŸ¥æ‰¾èµ„æ–™å¯ä»¥çŸ¥é“ï¼ŒååŒè¿‡æ»¤ç®—æ³•åœ¨å¤§æ•°æ®æƒ…å†µä¸‹ï¼Œç”±äºè®¡ç®—é‡è¾ƒå¤§ï¼Œä¸èƒ½åšåˆ°å®æ—¶åœ°å¯¹ç”¨æˆ·è¿›è¡Œæ¨èã€‚åŸºäºæ¨¡å‹çš„ååŒè¿‡æ»¤ç®—æ³•æœ‰æ•ˆè§£å†³äº†è¿™ä¸€é—®é¢˜ï¼ŒçŸ©é˜µåˆ†è§£æ˜¯åŸºäºæ¨¡å‹çš„ååŒè¿‡æ»¤ç®—æ³•ä¸­çš„ä¸€ç§ï¼Œåœ¨åŸºäºæ¨¡å‹çš„ååŒè¿‡æ»¤ç®—æ³•ä¸­ï¼Œåˆ©ç”¨å†å²æ•°æ®è®­ç»ƒå¾—åˆ°æ¨¡å‹ï¼Œå¹¶åˆ©ç”¨è¯¥æ¨¡å‹å®ç°å®æ—¶æ¨èã€‚

â€¢     æˆ‘ä»¬åº”å½“æ ¹æ®å®é™…æƒ…å†µä»¥åŠå®é™…éœ€æ±‚ï¼Œæ¥é€‰æ‹©åˆé€‚çš„æ¨èç®—æ³•ã€‚